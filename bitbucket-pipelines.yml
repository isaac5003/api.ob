image: docker/compose
pipelines:
  pull-requests:
    '**':
      - step:
          name: Build Images
          services:
            - docker
          caches:
            - node
          script:
            - docker-compose -f docker-compose.test.yml up -d
            - apk add --update nodejs npm
            - apk add curl
            - npm install
            - docker container ls -a
            - sleep 10
            - docker container ls -a
            - docker container logs test_openbox_api
            - curl http://0.0.0.0:8001
            - curl http://localhost:8001
            - npm run test:e2e